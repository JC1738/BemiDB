# ============================================================================
# BemiDB DuckLake Configuration Template
# ============================================================================
#
# SETUP INSTRUCTIONS:
#
# 1. Copy this file to create your configuration:
#    cp .env.ducklake.sample .env.ducklake
#
# 2. Replace all [REPLACE_WITH_*] placeholders with your actual values
#
# 3. Run with Docker Compose (recommended for local testing):
#    docker-compose -f docker-compose.ducklake.yml up
#
# 4. Or run directly with Docker:
#    docker build -f Dockerfile.ducklake -t bemidb-ducklake:latest .
#    docker run --env-file .env.ducklake -p 54321:54321 bemidb-ducklake:latest
#
# 5. Connect with psql:
#    psql "host=localhost port=54321 user=postgres dbname=bemidb"
#    (Adjust user/dbname based on your BEMIDB_USER and BEMIDB_DATABASE settings)
#
# ============================================================================
# DuckLake Catalog Configuration
# ============================================================================

# PostgreSQL connection string for DuckLake catalog
# Format: "host=HOST port=PORT dbname=DBNAME user=USER password=PASSWORD"
# Example: "host=ep-xxx.us-east-1.aws.neon.tech port=5432 dbname=ducklake_catalog user=xxx password=xxx"
DUCKLAKE_CATALOG_URL="[REPLACE_WITH_YOUR_CATALOG_CONNECTION_STRING]"

# DuckLake catalog name (as used in ATTACH statement)
# This is the logical name for your data lake catalog
DUCKLAKE_CATALOG_NAME="[REPLACE_WITH_YOUR_CATALOG_NAME]"

# DuckLake data path in R2 storage
# Must match the data path configured in your DuckLake catalog
# Format: r2://bucket-name/ or r2://bucket-name/prefix/
DUCKLAKE_DATA_PATH="r2://[REPLACE_WITH_YOUR_BUCKET_NAME]/"

# ============================================================================
# R2 Storage Credentials (Cloudflare R2)
# ============================================================================

# R2 account ID (found in Cloudflare R2 dashboard)
R2_ACCOUNT_ID="[REPLACE_WITH_YOUR_R2_ACCOUNT_ID]"

# R2 access credentials (create in R2 dashboard â†’ Manage R2 API Tokens)
R2_ACCESS_KEY_ID="[REPLACE_WITH_YOUR_R2_ACCESS_KEY_ID]"
R2_SECRET_ACCESS_KEY="[REPLACE_WITH_YOUR_R2_SECRET_ACCESS_KEY]"

# ============================================================================
# BemiDB Server Configuration
# ============================================================================

# Network settings
BEMIDB_HOST=0.0.0.0                      # Listen on all interfaces (default: 0.0.0.0)
BEMIDB_PORT=54321                        # PostgreSQL wire protocol port (default: 54321)

# Database name - CUSTOMIZE THIS for your deployment
# This is the database name clients will use to connect
# Change "bemidb" to your company/project name (e.g., "analytics", "datawarehouse")
BEMIDB_DATABASE=bemidb                   # Database name (default: bemidb)

# Authentication (RECOMMENDED for production)
# If both USER and PASSWORD are set, authentication is enforced
# If left empty (""), authentication is disabled and anyone can connect
# BEMIDB_USER=analytics_user             # Username for authentication (optional)
# BEMIDB_PASSWORD=SecurePassword123!     # Password for authentication (optional)

# Connection limits
# BEMIDB_MAX_CONNECTIONS=100             # Maximum concurrent connections (default: 100)

# Logging
BEMIDB_LOG_LEVEL=INFO                    # Log level: ERROR, WARN, INFO, DEBUG, TRACE (default: INFO)
BEMIDB_DISABLE_ANONYMOUS_ANALYTICS=true  # Disable anonymous usage analytics (default: false)

# ============================================================================
# DuckDB Performance Configuration
# ============================================================================

# Memory limit for DuckDB query engine
# Adjust based on your server's available RAM
# Examples: '1GB', '2GB', '4GB', '8GB', '16GB', '32GB'
# BEMIDB_MEMORY_LIMIT=3GB                # Default: 3GB

# Number of threads for parallel query execution
# Set to 0 to auto-detect based on CPU cores (recommended)
# Set to specific number to limit thread usage (useful in shared environments)
# BEMIDB_THREADS=0                       # Default: 0 (auto-detect)

# Query timeout in seconds
# Queries running longer than this will be cancelled
# Adjust based on your typical query patterns
# BEMIDB_QUERY_TIMEOUT=300               # Default: 300 (5 minutes)

# Temporary directory for DuckDB spill-to-disk operations
# Used when queries exceed available memory
# Point to fast storage (SSD/NVMe) for best performance
# If not set, DuckDB uses system temp directory
# BEMIDB_TEMP_DIRECTORY=/fast/storage/tmp

# ============================================================================
# Legacy Iceberg Configuration (DEPRECATED - only for non-DuckLake mode)
# ============================================================================

# These variables are only needed if NOT using DuckLake
# When DUCKLAKE_CATALOG_URL is set, these are ignored

# CATALOG_DATABASE_URL="postgres://..."  # Deprecated: Use DUCKLAKE_CATALOG_URL instead
# AWS_REGION=us-east-1                   # Deprecated: Use R2 instead
# AWS_S3_BUCKET=my-bucket                # Deprecated: Use DUCKLAKE_DATA_PATH instead
# AWS_S3_ENDPOINT=s3.amazonaws.com       # Deprecated: Use R2 instead
# AWS_ACCESS_KEY_ID=AKIA...              # Deprecated: Use R2_ACCESS_KEY_ID instead
# AWS_SECRET_ACCESS_KEY=...              # Deprecated: Use R2_SECRET_ACCESS_KEY instead

# ============================================================================
# Complete Environment Variables Reference
# ============================================================================

# Server:
#   BEMIDB_HOST                    - Listen address (default: 0.0.0.0)
#   BEMIDB_PORT                    - Listen port (default: 54321)
#   BEMIDB_DATABASE                - Database name (default: bemidb)
#   BEMIDB_USER                    - Username (optional, disabled if not set)
#   BEMIDB_PASSWORD                - Password (optional, disabled if not set)
#   BEMIDB_MAX_CONNECTIONS         - Max concurrent connections (default: 100)
#   BEMIDB_LOG_LEVEL               - Log level (default: INFO)
#   BEMIDB_DISABLE_ANONYMOUS_ANALYTICS - Disable analytics (default: false)
#
# DuckDB Performance:
#   BEMIDB_MEMORY_LIMIT            - Memory limit (default: 3GB)
#   BEMIDB_THREADS                 - Thread count (default: 0 = auto-detect)
#   BEMIDB_QUERY_TIMEOUT           - Query timeout in seconds (default: 300)
#   BEMIDB_TEMP_DIRECTORY          - Temp directory for spill-to-disk (optional)
#
# DuckLake:
#   DUCKLAKE_CATALOG_URL           - Catalog database connection string (required)
#   DUCKLAKE_CATALOG_NAME          - Catalog name (required)
#   DUCKLAKE_DATA_PATH             - R2 data path (required)
#
# R2 Storage:
#   R2_ACCOUNT_ID                  - R2 account ID (required)
#   R2_ACCESS_KEY_ID               - R2 access key (required)
#   R2_SECRET_ACCESS_KEY           - R2 secret key (required)
#
# Legacy (Deprecated):
#   CATALOG_DATABASE_URL           - Legacy Iceberg catalog
#   AWS_REGION                     - Legacy AWS region
#   AWS_S3_BUCKET                  - Legacy S3 bucket
#   AWS_S3_ENDPOINT                - Legacy S3 endpoint
#   AWS_ACCESS_KEY_ID              - Legacy AWS credentials
#   AWS_SECRET_ACCESS_KEY          - Legacy AWS credentials
